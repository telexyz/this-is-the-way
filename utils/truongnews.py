files = '''vietnews-dataset/data/train-00000-of-00138-4c6102be86ee5455.parquet
vietnews-dataset/data/train-00001-of-00138-faa3589a745bc75c.parquet
vietnews-dataset/data/train-00002-of-00138-5487f103bc0537f0.parquet
vietnews-dataset/data/train-00003-of-00138-7701aeefce26c92a.parquet
vietnews-dataset/data/train-00004-of-00138-116c0f52e9525cfe.parquet
vietnews-dataset/data/train-00005-of-00138-b0bcfff16aa257f6.parquet
vietnews-dataset/data/train-00006-of-00138-7d6ba6482f58d1f4.parquet
vietnews-dataset/data/train-00007-of-00138-b54dad0b1c1dfb43.parquet
vietnews-dataset/data/train-00008-of-00138-ecf5a3b18a114f7c.parquet
vietnews-dataset/data/train-00009-of-00138-d1353cb296330579.parquet
vietnews-dataset/data/train-00010-of-00138-76919fc7ee8a3877.parquet
vietnews-dataset/data/train-00011-of-00138-583bf87983b7cebb.parquet
vietnews-dataset/data/train-00012-of-00138-c6021e3ea30f405a.parquet
vietnews-dataset/data/train-00013-of-00138-aceb3d6b534c72a6.parquet
vietnews-dataset/data/train-00014-of-00138-99a64081da52d614.parquet
vietnews-dataset/data/train-00015-of-00138-b533c21de0bbb646.parquet
vietnews-dataset/data/train-00016-of-00138-49aec35417bc6931.parquet
vietnews-dataset/data/train-00017-of-00138-b1e18e8ac59778e0.parquet
vietnews-dataset/data/train-00018-of-00138-7a3028ed79aaa8bc.parquet
vietnews-dataset/data/train-00019-of-00138-ce5571717492f386.parquet
vietnews-dataset/data/train-00020-of-00138-17373ac3f470faf3.parquet
vietnews-dataset/data/train-00021-of-00138-c68977fa73d266b9.parquet
vietnews-dataset/data/train-00022-of-00138-291c7ace10b9e326.parquet
vietnews-dataset/data/train-00023-of-00138-6939e03d8b59bfd9.parquet
vietnews-dataset/data/train-00024-of-00138-8c72de8bd5c8e8f0.parquet
vietnews-dataset/data/train-00025-of-00138-deb3221a9fbe46a3.parquet
vietnews-dataset/data/train-00026-of-00138-cdf4e8db935ae3b8.parquet
vietnews-dataset/data/train-00027-of-00138-fb6d8c53a58b8df7.parquet
vietnews-dataset/data/train-00028-of-00138-6a3e4f5b454b86cb.parquet
vietnews-dataset/data/train-00029-of-00138-faa01a8b7e9c5cbd.parquet
vietnews-dataset/data/train-00030-of-00138-285e418a6706c7f2.parquet
vietnews-dataset/data/train-00031-of-00138-ac25bb7b0226f948.parquet
vietnews-dataset/data/train-00032-of-00138-e1a8b1a1aa73bf07.parquet
vietnews-dataset/data/train-00033-of-00138-37f5063f983090c1.parquet
vietnews-dataset/data/train-00034-of-00138-9af854277d823bff.parquet
vietnews-dataset/data/train-00035-of-00138-78ccbbbd9a526374.parquet
vietnews-dataset/data/train-00036-of-00138-8fc6cf231cdbaef1.parquet
vietnews-dataset/data/train-00037-of-00138-3b2a64b65bac7e6f.parquet
vietnews-dataset/data/train-00038-of-00138-3de18f0a94474c08.parquet
vietnews-dataset/data/train-00039-of-00138-53d5f8f3ab8ad8b3.parquet
vietnews-dataset/data/train-00040-of-00138-58d2baf08cb486e0.parquet
vietnews-dataset/data/train-00041-of-00138-b03d5a6ec7330087.parquet
vietnews-dataset/data/train-00042-of-00138-d06bb584139cec3f.parquet
vietnews-dataset/data/train-00043-of-00138-103b7547bf75a360.parquet
vietnews-dataset/data/train-00044-of-00138-8d3a9d357116244f.parquet
vietnews-dataset/data/train-00045-of-00138-ba1e3c8abf123e41.parquet
vietnews-dataset/data/train-00046-of-00138-953e84779c63ac53.parquet
vietnews-dataset/data/train-00047-of-00138-8775f3988e162711.parquet
vietnews-dataset/data/train-00048-of-00138-f1be6db3ae86c3d8.parquet
vietnews-dataset/data/train-00049-of-00138-50680e8b262f42b5.parquet
vietnews-dataset/data/train-00050-of-00138-b29d3980d831c604.parquet
vietnews-dataset/data/train-00051-of-00138-5990e794e9ed981e.parquet
vietnews-dataset/data/train-00052-of-00138-8e4eabbf356e11cc.parquet
vietnews-dataset/data/train-00053-of-00138-81f18e51b3b88528.parquet
vietnews-dataset/data/train-00054-of-00138-2309bec4af5a1dca.parquet
vietnews-dataset/data/train-00055-of-00138-f1d7c89a33b295db.parquet
vietnews-dataset/data/train-00056-of-00138-2f04233326fa7c2d.parquet
vietnews-dataset/data/train-00057-of-00138-d98774f57bc34388.parquet
vietnews-dataset/data/train-00058-of-00138-8cd4af1de75de40f.parquet
vietnews-dataset/data/train-00059-of-00138-ec8dd2b432e6f3a8.parquet
vietnews-dataset/data/train-00060-of-00138-83b837dcdae349ea.parquet
vietnews-dataset/data/train-00061-of-00138-d57bf49d88c252c8.parquet
vietnews-dataset/data/train-00062-of-00138-c6f8b7ea70db43d1.parquet
vietnews-dataset/data/train-00063-of-00138-1dc0ca9b5736a7f5.parquet
vietnews-dataset/data/train-00064-of-00138-b51bb377f0683824.parquet
vietnews-dataset/data/train-00065-of-00138-fbf8707dda13f345.parquet
vietnews-dataset/data/train-00066-of-00138-107cab24394a20c9.parquet
vietnews-dataset/data/train-00067-of-00138-7a302416bc71eb71.parquet
vietnews-dataset/data/train-00068-of-00138-b937dc4e680a11b5.parquet
vietnews-dataset/data/train-00069-of-00138-2631c5ee3931d3e1.parquet
vietnews-dataset/data/train-00070-of-00138-7bac1a0cabf5cf1c.parquet
vietnews-dataset/data/train-00071-of-00138-901033002b6459ce.parquet
vietnews-dataset/data/train-00072-of-00138-ed20fa2e908a988d.parquet
vietnews-dataset/data/train-00073-of-00138-8036e2580001892d.parquet
vietnews-dataset/data/train-00074-of-00138-32c02f5197b9ccd3.parquet
vietnews-dataset/data/train-00075-of-00138-ca2097b716db0716.parquet
vietnews-dataset/data/train-00076-of-00138-5b7e8bd5fcd82b25.parquet
vietnews-dataset/data/train-00077-of-00138-75c772cd52e5565f.parquet
vietnews-dataset/data/train-00078-of-00138-72f26ad2b09e2749.parquet
vietnews-dataset/data/train-00079-of-00138-1b2326e6d871da21.parquet
vietnews-dataset/data/train-00080-of-00138-470c691e74becd04.parquet
vietnews-dataset/data/train-00081-of-00138-be7dcc7b57b05fec.parquet
vietnews-dataset/data/train-00082-of-00138-fffd3d815e6bddb1.parquet
vietnews-dataset/data/train-00083-of-00138-80fd2e59d2e6762d.parquet
vietnews-dataset/data/train-00084-of-00138-5515c196c072059e.parquet
vietnews-dataset/data/train-00085-of-00138-3ceb454ef9be4004.parquet
vietnews-dataset/data/train-00086-of-00138-c0bd3136cee11567.parquet
vietnews-dataset/data/train-00087-of-00138-761eec9c4f971eb9.parquet
vietnews-dataset/data/train-00088-of-00138-0e1ff69d3be68256.parquet
vietnews-dataset/data/train-00089-of-00138-4e85f839114eac8f.parquet
vietnews-dataset/data/train-00090-of-00138-f4ac6880c6382a12.parquet
vietnews-dataset/data/train-00091-of-00138-9525378f7e9f8c45.parquet
vietnews-dataset/data/train-00092-of-00138-96c0d404e321ece5.parquet
vietnews-dataset/data/train-00093-of-00138-12057885ae1b973b.parquet
vietnews-dataset/data/train-00094-of-00138-97f2dbdfdb6e9082.parquet
vietnews-dataset/data/train-00095-of-00138-c13a41c0f555f748.parquet
vietnews-dataset/data/train-00096-of-00138-9e538eb1da6c454e.parquet
vietnews-dataset/data/train-00097-of-00138-039e8ee20b826faa.parquet
vietnews-dataset/data/train-00098-of-00138-a70e96b02100b178.parquet
vietnews-dataset/data/train-00099-of-00138-2cfcebe2424a6f4d.parquet
vietnews-dataset/data/train-00100-of-00138-4a6ed65a38620b57.parquet
vietnews-dataset/data/train-00101-of-00138-9e37ebe95d267e30.parquet
vietnews-dataset/data/train-00102-of-00138-7311de599f3dfac6.parquet
vietnews-dataset/data/train-00103-of-00138-79e4cfcc102d2ad0.parquet
vietnews-dataset/data/train-00104-of-00138-ea65590cda71e42d.parquet
vietnews-dataset/data/train-00105-of-00138-c854139e18a1e28d.parquet
vietnews-dataset/data/train-00106-of-00138-8738bf63091c5835.parquet
vietnews-dataset/data/train-00107-of-00138-84ada85180ecdb01.parquet
vietnews-dataset/data/train-00108-of-00138-aa52bf19d7802437.parquet
vietnews-dataset/data/train-00109-of-00138-b5036339cff7899a.parquet
vietnews-dataset/data/train-00110-of-00138-f7a2e846d71776a8.parquet
vietnews-dataset/data/train-00111-of-00138-84326bf4aa3a3250.parquet
vietnews-dataset/data/train-00112-of-00138-c9856d902be7b548.parquet
vietnews-dataset/data/train-00113-of-00138-2d4958629558bfbd.parquet
vietnews-dataset/data/train-00114-of-00138-e930e571d0c0f0e1.parquet
vietnews-dataset/data/train-00115-of-00138-38869f41cd7d596d.parquet
vietnews-dataset/data/train-00116-of-00138-afc05cab90119bc0.parquet
vietnews-dataset/data/train-00117-of-00138-eb8e5f843e5521bd.parquet
vietnews-dataset/data/train-00118-of-00138-2d2635b59b0b5381.parquet
vietnews-dataset/data/train-00119-of-00138-c3a0209b8c8b16dc.parquet
vietnews-dataset/data/train-00120-of-00138-0b7f7e24d3ad5f4c.parquet
vietnews-dataset/data/train-00121-of-00138-53f928ac8258b5c1.parquet
vietnews-dataset/data/train-00122-of-00138-0b2bc2b319fddfbd.parquet
vietnews-dataset/data/train-00123-of-00138-a5233e79f2b2cab6.parquet
vietnews-dataset/data/train-00124-of-00138-9c01b2fabed2b17a.parquet
vietnews-dataset/data/train-00125-of-00138-0cd7dc3e821dbb6c.parquet
vietnews-dataset/data/train-00126-of-00138-2c2d94bd8408f33f.parquet
vietnews-dataset/data/train-00127-of-00138-dacc6c8af493900f.parquet
vietnews-dataset/data/train-00128-of-00138-2ee04dd8a8248d47.parquet
vietnews-dataset/data/train-00129-of-00138-d24997907e3cb721.parquet
vietnews-dataset/data/train-00130-of-00138-a5afac2feacd3b99.parquet
vietnews-dataset/data/train-00131-of-00138-7d83d1166aa03816.parquet
vietnews-dataset/data/train-00132-of-00138-d0c89c2a6439746b.parquet
vietnews-dataset/data/train-00133-of-00138-3bf9dfd4f31259d0.parquet
vietnews-dataset/data/train-00134-of-00138-2130f1fd0e9db9a5.parquet
vietnews-dataset/data/train-00135-of-00138-5a8b6b81005d2654.parquet
vietnews-dataset/data/train-00136-of-00138-90fe1bd440a2cb35.parquet
vietnews-dataset/data/train-00137-of-00138-c2e21bc58bdb4d24.parquet'''

import pandas as pd
import subprocess

for i in range(2, 13):
	b = i * 10
	e = b + 9
	prefix = f"truongnews-{b:03d}-{e:03d}"
	with open(f"{prefix}.txt", "w", encoding="utf-8") as f:
		for i, file in enumerate(files.split("\n")[b:e+1]):
			df = pd.read_parquet(file)
			for text in df["text"]:
				f.write(text.replace("\n"," \\n "))
				f.write("\n")

	subprocess.run(f"../telexify {prefix}.txt {prefix}.utf8 utf8", shell=True)
	subprocess.run(f"7zz a -mx9 {prefix}.utf8.7z {prefix}.utf8", shell=True)
	subprocess.run(f"rm {prefix}.txt", shell=True)
	subprocess.run(f"rm {prefix}.utf8", shell=True)
